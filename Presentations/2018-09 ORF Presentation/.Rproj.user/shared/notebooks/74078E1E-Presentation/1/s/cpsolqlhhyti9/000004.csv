"0","library(tidyverse)"
"2","[30mâ”€â”€ [1mAttaching packages[22m â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse 1.2.1 â”€â”€[39m
"
"2","[30m[32mâœ”[30m [34mggplot2[30m 3.0.0     [32mâœ”[30m [34mpurrr  [30m 0.2.5
[32mâœ”[30m [34mtibble [30m 1.4.2     [32mâœ”[30m [34mdplyr  [30m 0.7.6
[32mâœ”[30m [34mtidyr  [30m 0.8.1     [32mâœ”[30m [34mstringr[30m 1.3.1
[32mâœ”[30m [34mreadr  [30m 1.1.1     [32mâœ”[30m [34mforcats[30m 0.3.0[39m
"
"2","[30mâ”€â”€ [1mConflicts[22m â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse_conflicts() â”€â”€
[31mâœ–[30m [34mdplyr[30m::[32mfilter()[30m masks [34mstats[30m::filter()
[31mâœ–[30m [34mdplyr[30m::[32mlag()[30m    masks [34mstats[30m::lag()[39m
"
"0","library(rstan)"
"2","Loading required package: StanHeaders
"
"2","rstan (Version 2.17.3, GitRev: 2e1f913d3ca3)
"
"2","For execution on a local, multicore CPU with excess RAM we recommend calling
options(mc.cores = parallel::detectCores()).
To avoid recompilation of unchanged Stan programs, we recommend calling
rstan_options(auto_write = TRUE)
"
"2","
Attaching package: â€˜rstanâ€™

"
"2","The following object is masked from â€˜package:tidyrâ€™:

    extract

"
"0","library(broom)"
"0","rstan_options(auto_write = TRUE)"
"0","options(mc.cores = parallel::detectCores())"
"0",""
"0","theme_set(theme_minimal())"
"0",""
"0","sim <- stan(file='~/Google Drive/PhD/Code/all_updated_exercises/1 - one_comp_lin_elim_abs/sim_one_comp_lin_elim_abs.stan', iter=1,chains=1, seed=194838, algorithm=""Fixed_param"")"
"1","
"
"1",""
"1","SAMPLING"
"1",""
"1"," FOR MODEL '"
"1",""
"1","sim_one_comp_lin_elim_abs"
"1",""
"1","' NOW (CHAIN "
"1",""
"1","1"
"1",""
"1",").
"
"1","Iteration: 1 / 1 [100%]  (Sampling)"
"1","
"
"1","
"
"1"," Elapsed Time: 0 seconds (Warm-up)"
"1","
"
"1","               0.000569 seconds (Sampling)"
"1","
"
"1","               0.000569 seconds (Total)"
"1","
"
"1","
"
"0","t0 = rstan::extract(sim)$t_init[1]"
"0","C0 = array(rstan::extract(sim)$C_init[1,], dim = 1)"
"0","D = rstan::extract(sim)$D[1]"
"0","V = rstan::extract(sim)$V[1]"
"0","times = rstan::extract(sim)$ts[1,]"
"0","N_t = length(rstan::extract(sim)$ts[1,])"
"0","C_hat = rstan::extract(sim)$C_hat[1,]"
"0",""
"0","y<- function(t,k,k_a){"
"0","  y_0 = 1"
"0","  D = 30.0"
"0","  V = 2.0"
"0",""
"0","yhat <- (0.1e1 / (k - k_a) * D / V * k_a * exp(t * (k - k_a)) - 0.1e1 / (k - k_a) * k_a / V * D) * exp(-k * t)  "
"0",""
"0","return(yhat)"
"0","}"
"0",""
"0","concentration.data = tibble(t= times, c = C_hat)"
"0","true_solution = tibble(t = seq(0,10,0.01), ys = y(t, k = 0.5, k_a = 0.75))"
"0",""
"0",""
"0","elimination.data = data.frame(Time = seq(0,10,0.01)) %>% "
"0","                    mutate(Y = y(Time,0.5,0.75))"
"0",""
"0","elimination.plot = elimination.data %>% "
"0","                    ggplot(aes(Time,Y))+"
"0","                    geom_line(size = 2, alpha = 0.5)+"
"0","                    theme(aspect.ratio = 1/2, axis.title = element_text(size = 22))+"
"0","                    labs(x = 'Time', y = 'Concentration')"
"0",""
"0","elimination.plot"
