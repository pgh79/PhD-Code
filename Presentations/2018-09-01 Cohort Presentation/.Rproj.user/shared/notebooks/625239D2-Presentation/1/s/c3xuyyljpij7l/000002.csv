"0","library(patchwork)"
"0",""
"0","flips.fair = crossing(block = 1:nblock, round = -nround:-1, flip = 1:nflip)"
"0","n = prod(c(nflip,nround,nblock))"
"0","flips.fair %<>% mutate(result = sample(coin, replace = T, size = n))"
"0",""
"0","fair.plot <-flips.fair %>% "
"0","  ggplot(aes(flip,round)) +"
"0","  geom_tile(aes(fill= result), color = 'black', size = 1)+"
"0","  theme_void()+"
"0","  coord_equal()+"
"0","  scale_fill_brewer(palette = 'Set1' )+"
"0","  facet_wrap(~block, nrow = 3)+"
"0","  theme(legend.position = 'bottom',   strip.background = element_blank(), strip.text.x = element_blank())+"
"0","  guides(fill=guide_legend(title = ''))"
"0",""
"0",""
"0","(unfair.plot+ guides(fill = F)) + (fair.plot + guides(fill = F))"
